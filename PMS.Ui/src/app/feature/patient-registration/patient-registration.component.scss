::ng-deep .snack-error { background:#b00020; color:#fff; }

.patient-form-container {
  padding: 1.5rem 1.75rem 3rem;
  background: #f5f6fa;
  border-radius: 14px;
  position: relative;
  font-family: "Roboto", Arial, sans-serif;

  .auth-card {
  padding: 1.1rem 1.25rem 1.35rem;
    margin-bottom: 1.25rem;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05), 0 1px 2px rgba(0,0,0,0.08);
    background:#fff;
  }

  .snapshot-card {
  .snapshot-header { display:flex; align-items:center; gap:1rem; padding:.25rem .25rem .5rem; }
  .snapshot-spacer { flex:1; }
  .avatar { width:56px; height:56px; border-radius:50%; background:linear-gradient(135deg,#673ab7,#3f51b5); color:#fff; display:flex; align-items:center; justify-content:center; font-size:1.2rem; font-weight:600; box-shadow:0 2px 4px rgba(0,0,0,.18); }
  .title-block h2 { margin:0; font-size:1.35rem; letter-spacing:.5px; }
  .title-block .subline { font-size:.63rem; letter-spacing:.8px; text-transform:uppercase; color:#607d8b; margin-top:.15rem; font-weight:600; }
  .title-block mat-progress-bar { height:6px; border-radius:4px; margin-top:.4rem; }
  mat-divider { margin: .4rem 0 .9rem; }
  .meta { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 15px;}
  .field { display:flex; flex-direction:column; width: 30%; }
  .field label { font-size:.62rem; font-weight:600; text-transform:uppercase; letter-spacing:.7px; color:#5a6270; margin-bottom:.15rem; }
  .field span { font-size:.9rem; font-weight:500; color:#1c2834; display:flex; align-items:center; gap:.25rem; }
  .mini-icon { width:24px; height:24px; line-height:24px; margin-left:.15rem; }
  .truncate { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:180px; }
  .tags { grid-column:1 / -1; }
  .tag-header { display:flex; align-items:center; gap:1rem; margin-bottom:.4rem; }
  .tag-meta { display:flex; align-items:center; gap:.35rem; }
  .tag-meta .count { background:#eceff3; color:#45515f; font-size:.65rem; padding:.25rem .5rem; border-radius:10px; font-weight:600; letter-spacing:.5px; }
  .tag-header label { font-size:.7rem; font-weight:600; text-transform:uppercase; letter-spacing:.8px; color:#5a6270; }
  mat-chip-listbox { display:flex; flex-wrap:wrap; gap:.4rem; max-height:110px; overflow:hidden; }
  :host-context(.dark-theme) .avatar { background:linear-gradient(135deg,#9575cd,#5c6bc0); }
  button[mat-button] { font-size:.65rem; padding:0 .35rem; line-height:1.6rem; }
  /* Insurance snapshot styles */
  .insurance-snapshot { margin-top:.75rem; padding:.75rem .9rem .85rem; border:1px solid #e2e7ee; background:#fafbfc; border-radius:10px; position:relative; }
  .insurance-snapshot .ins-header { display:flex; align-items:center; gap:.6rem; margin-bottom:.55rem; }
  .insurance-snapshot .ins-title { font-size:.75rem; font-weight:600; letter-spacing:.7px; text-transform:uppercase; color:#5a6270; }
  .insurance-snapshot .pill { font-size:.55rem; letter-spacing:.6px; text-transform:uppercase; padding:.25rem .5rem; border-radius:30px; font-weight:600; background:#dfe7ff; color:#2c3d5a; }
  .insurance-snapshot .pill.primary { background:#d9f3e4; color:#1a5c37; }
  .insurance-snapshot .pill.secondary { background:#fff3d6; color:#7a5612; }
  .insurance-snapshot .ins-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:.65rem .9rem; }
  .insurance-snapshot .ins-field { display:flex; flex-direction:column; }
  .insurance-snapshot .ins-field label { font-size:.55rem; font-weight:600; text-transform:uppercase; letter-spacing:.6px; color:#6a7280; margin-bottom:.2rem; }
  .insurance-snapshot .ins-field span { font-size:.78rem; font-weight:500; color:#1f2b38; }
  @media (max-width: 820px) { .snapshot-sections { grid-template-columns:1fr; } .meta { grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); } }
  }

  .form-card form { position:relative; }

  h2 { font-size: 1.05rem; font-weight:600; letter-spacing:.3px; margin:1.2rem 0 .65rem; }

  .form-row {
    display:flex; flex-wrap:wrap; gap:1rem; margin-bottom:.5rem;
    mat-form-field { flex:1 1 calc(25% - 1rem); min-width:200px; }
    mat-form-field.full-width { flex:1 1 100%; }
  }

  .medical-row.compact-row {
    gap:.6rem;
    mat-form-field { flex:1 1 calc(20% - .6rem); min-width:170px; }
    .compact-field { flex:1 1 calc(25% - .6rem); }
    .notes-field { flex:1 1 100%; }
    ::ng-deep .mat-mdc-form-field-infix { padding-top:.4rem; padding-bottom:.4rem; }
    ::ng-deep .mat-mdc-text-field-wrapper { min-height:44px; }
    textarea { resize: vertical; }
  }

  .insurance-row { align-items:flex-start; }
  .checkbox-column { display:flex; flex-direction:column; padding-top:.75rem; gap:.35rem; }

  .form-actions { 
    display:flex; align-items:center; gap:.75rem; margin-top:1.2rem; position:sticky; bottom:0; background:#fff; padding:.75rem 0 .25rem; z-index:2;
    .spacer { flex:1; }
    button { min-width:140px; }
    mat-progress-spinner { margin-right:.5rem; }
  }

  .loading-overlay { position:absolute; inset:0; background:rgba(255,255,255,0.55); backdrop-filter:blur(1px); display:flex; align-items:center; justify-content:center; border-radius:12px; z-index:5; }

  @media (max-width:1100px) { .form-row mat-form-field { flex:1 1 calc(50% - 1rem); } }
  @media (max-width:700px) { .form-row mat-form-field { flex:1 1 100%; } .form-actions { flex-wrap:wrap; button { flex:1 1 calc(50% - .75rem); } } }
}

/* Compact mode overrides */
.compact-surface { border-radius:10px; }
.compact-form {
  h2 { margin: .9rem 0 .4rem; font-size:1rem; }
  .form-row { gap:.55rem; margin-bottom:.35rem; }
  .form-row mat-form-field { min-width:160px; }
  ::ng-deep .mat-mdc-form-field-subscript-wrapper { margin-top: -4px; }
  ::ng-deep .mat-mdc-text-field-wrapper { min-height:42px; }
  ::ng-deep .mat-mdc-form-field-infix { padding-top:.35rem; padding-bottom:.35rem; }
  .form-actions { padding:.55rem 0 0; margin-top:.75rem; }
  .form-actions button { min-width:120px; }
}

/* Autocomplete styling */
::ng-deep .mat-mdc-autocomplete-panel {
  padding-top:.25rem; padding-bottom:.4rem;
  .mat-mdc-option { padding:.35rem .85rem .4rem; line-height:1.2; }
}

.auto-item { display:flex; flex-direction:column; }
.auto-item .name { font-weight:500; font-size:.9rem; color:#1e2a33; }
.auto-item .meta { font-size:.65rem; letter-spacing:.4px; color:#607d8b; margin-top:.15rem; }
::ng-deep .mat-mdc-option.mdc-list-item--selected .auto-item .name { color:#3f51b5; }
::ng-deep .mat-mdc-option:hover .auto-item .name { text-decoration:underline; }

.responsible-radio-group { display:flex; align-items:center; gap:1rem; }
.responsible-radio-group .group-label { font-size:.82rem; font-weight:500; color:#1e2a33; }
.inline-radios { display:flex; gap:.95rem; }

.selected-chip { margin:.35rem 0 .2rem; background:#eef2ff; padding:.4rem .65rem; border-radius:18px; font-size:.7rem; font-weight:500; color:#2d3d52; display:inline-flex; align-items:center; gap:.4rem; }

.insurance-wrapper { margin-top:1.25rem; padding:1rem 1.1rem 1.2rem; border:1px solid #dfe5ec; border-radius:10px; background:#ffffff; box-shadow:0 1px 2px rgba(0,0,0,0.04); }
.insurance-wrapper h2 { margin-top:0; }
.insurance-actions { display:flex; align-items:flex-end; padding-bottom:.4rem; }
